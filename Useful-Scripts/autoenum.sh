#!/bin/bash
read -p "subnet/system to scan: " subnet
nmap -sV -O -sS -T4 $subnet -oG grepmap.txt
for server in $(grep Up grepmap.txt | cut -d " " -f 2)
  do
  mkdir $server; nmblookup -A $server >> $server/netbiosnames.$server
  nmap -A -sV -sC -oN $server/quickmap.$server $server
  nmap -sU -sT --script=smb-enum-users -p U:137,T:139 $server -oN $server/smbuserenum.$server
  snmpenum -t $server >> $server/snmpenum.$server
  nmap -sV -p 161 --script=snmp-info $server -oN $server/snmpinfo.$server
  enum4linux $server >> $server/enum4linux.$server.txt
  ldapsearch -H ldap://$server -x -LLL -s base -b "" namingContexts > $server/ldap.$server
  ldapsearch -H ldaps://$server -x -LLL -s base -b "" namingContexts > $server/ldaps.$server
  nmap -sV --script=nfs-showmount -oN $server/nfsshares.$server $server
  nmap -T4 -v -oN $server/smbsharesnocreds.$server --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 $server
  nmap -A -sT -sV -sC -p- $server -oN $server/fullscan.connect.$server
done
