#!/bin/bash
## for this to run correctly you need to
## cd /usr/share/nmap/scripts/
## git clone https://github.com/vulnersCom/nmap-vulners.git
## cd /usr/share
## git clone https://github.com/scipag/vulscan scipag_vulscan
## ln -s `pwd`/scipag_vulscan /usr/share/nmap/scripts/vulscan

read -p "subnet/system to scan: " subnet
echo public > community
echo private >> community
echo manager >> community
nmap -sV -O -sS -T4 $subnet -oG grepmap.txt
for server in $(grep Up grepmap.txt | cut -d " " -f 2)
  do
  mkdir $server
  konsole -e nmap -vv -Pn –top-ports 1000 $server -oX $server/pn.$server &
  konsole -e konsole -e nikto -url http://$server >> $server/nikhttp &
  konsole -e nikto -url https://$server >> $server/nikhttps &
  konsole -e nmap -vv -O -P0 -sTUV –top-ports 1000 $server -oX $server/udptcp1000.$server &
  konsole -e nmblookup -A $server >> $server/netbiosnames.$server & 
  konsole -e nmap -A -sV -sC -oX $server/quickmap.$server $server &
  konsole -e nmap -sU -sT --script=smb-enum-users -p U:137,T:139 $server -oX $server/smbuserenum.$server &
  konsole -e snmpenum $server public windows.txt >> $server/windowssnmpenum.$server &
  konsole -e snmpenum $server public linux.txt >> $server/linuxsnmpenum.$server & 
  konsole -e onesixtyone $server -c community >> $server/161.$server &
  konsole -e nmap -sV -p 161 --script=snmp-info $server -oX $server/snmpinfo.$server &
  konsole -e enum4linux $server >> $server/enum4linux.$server.txt & 
  konsole -e ldapsearch -H ldap://$server -x -LLL -s base -b "" namingContexts > $server/ldap.$server &
  konsole -e ldapsearch -H ldaps://$server -x -LLL -s base -b "" namingContexts > $server/ldaps.$server &
  konsole -e nmap -sV --script=nfs-showmount -oX $server/nfsshares.$server $server &
  konsole -e nmap -T4 -v -oN $server/smbsharesnocreds.$server --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 $server &
  konsole -e nmap -A -sT -sV -sC -p- $server -oX $server/fullscan.connect.$server & 
  konsole -e nmap -sV --script=vulscan/vulscan.nse -p- $server -oX $server/vulscan.$server &
  konsole -e nmap --script nmap-vulners -sV -p- $server -oX $server/vulners.$server &
  konsole -e nmap -sV --script auth,discovery,external,version,vuln -p- $server -oX $server/vuln.$server 
  done
