#!/bin/bash
## for this to run correctly you need to
## cd /usr/share/nmap/scripts/
## git clone https://github.com/vulnersCom/nmap-vulners.git
## cd /usr/share
## git clone https://github.com/scipag/vulscan scipag_vulscan
## ln -s `pwd`/scipag_vulscan /usr/share/nmap/scripts/vulscan

read -p "subnet/system to scan: " subnet
echo public > community
echo private >> community
echo manager >> community
nmap -sV -O -sS -T4 $subnet -oG grepmap.txt
for server in $(grep Up grepmap.txt | cut -d " " -f 2)
  do
  mkdir $server; nmblookup -A $server >> $server/netbiosnames.$server
  nmap -A -sV -sC -oN $server/quickmap.$server $server
  nmap -sU -sT --script=smb-enum-users -p U:137,T:139 $server -oN $server/smbuserenum.$server
  snmpenum $server public windows.txt >> $server/windowssnmpenum.$server
  snmpenum $server public linux.txt >> $server/linuxsnmpenum.$server
  onesixtyone $server -c community >> $server/161.$server
  nmap -sV -p 161 --script=snmp-info $server -oN $server/snmpinfo.$server
  enum4linux $server >> $server/enum4linux.$server.txt
  ldapsearch -H ldap://$server -x -LLL -s base -b "" namingContexts > $server/ldap.$server
  ldapsearch -H ldaps://$server -x -LLL -s base -b "" namingContexts > $server/ldaps.$server
  nmap -sV --script=nfs-showmount -oN $server/nfsshares.$server $server
  nmap -T4 -v -oN $server/smbsharesnocreds.$server --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 $server
  nmap -A -sT -sV -sC -p- $server -oN $server/fullscan.connect.$server
  nmap -sV --script=vulscan/vulscan.nse -p- $server -oN $server/vulscan.$server
  nmap --script nmap-vulners -sV -p- $server -oN $server/vulners.$server
  nmap -sV --script vuln -p- $server -oN $server/vuln.$server
  nmap -vv -O -P0 -sTUV –top-ports 1000 $server -oN $server/udp-tcptop1000.$server
  nmap -vv -Pn –top-ports 1000 $server -oN $server/pn.$server
  nikto -url http://$server
  nikto -url https://$server
done
