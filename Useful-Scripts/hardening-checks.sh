echo "CHECK FOR RO FLAG IN OPTIONS SECTION, IF NO OUTPUT MANUALLY CHECK FSTAB:"
grep "/boot" /etc/fstab
echo "\r\n"
ls -la /etc/grub.conf
echo "^^ENSURE -rwx------ and root:root^^"
echo "VERIFIES USB STORAGE IS DISABLED:"
echo 'grep "blacklist usb_storage" /etc/modprobe.d/blacklist.conf'
grep "blacklist usb_storage" /etc/modprobe.d/blacklist.conf
echo 'grep "modprobe -r usb_storage" /etc/rc.local'
grep "modprobe -r usb_storage" /etc/rc.local
echo "\r\n"
echo "LISTS SERVICES LISTENING ON PORTS:"
netstat -antp
echo "\r\n"
echo "SSH CONFIG CHECKS:"
echo 'grep "PermitRootLogin" /etc/ssh/sshd_config << no'
grep "PermitRootLogin" /etc/ssh/sshd_config
echo 'grep "AllowUsers" /etc/ssh/sshd_config << restricted to required users'
grep "AllowUsers" /etc/ssh/sshd_config
echo 'grep "Protocol2" /etc/ssh/sshd_config should be proto 2 lol'
grep "Protocol2" /etc/ssh/sshd_config
echo 'grep "IgnoreRhosts" /etc/ssh/sshd_config << yes'
grep "IgnoreRhosts" /etc/ssh/sshd_config
echo 'grep "HostbasedAuthentication" /etc/ssh/sshd_config << no'
grep "HostbasedAuthentication" /etc/ssh/sshd_config
echo 'grep "PermitEmptyPasswords" /etc/ssh/sshd_config << no'
grep "PermitEmptyPasswords" /etc/ssh/sshd_config
echo 'grep "X11Forwarding" /etc/ssh/sshd_config << no'
grep "X11Forwarding" /etc/ssh/sshd_config
echo 'grep "MaxAuthTries" /etc/ssh/sshd_config << 5'
grep "MaxAuthTries" /etc/ssh/sshd_config
echo 'grep "Ciphers" /etc/ssh/sshd_config << only highest allowed by policy'
grep "Ciphers" /etc/ssh/sshd_config
echo 'grep "ClientAliveInterval" /etc/ssh/sshd_config << 900 or so'
grep "ClientAliveInterval" /etc/ssh/sshd_config
echo 'grep "ClientAliveCountMax" /etc/ssh/sshd_config << 0'
grep "ClientAliveCountMax" /etc/ssh/sshd_config
echo 'grep "UsePAM" /etc/ssh/sshd_config << yes'
grep "UsePAM" /etc/ssh/sshd_config
ls -la /etc/ssh/sshd_config
echo "^^ensure only WRITABLE BY ROOT^^"
echo "\r\n"
echo "shows SELINUX config if applicable:"
cat /etc/selinux/config
echo "\r\n"
echo "SYSCTL CHECKS:"
echo "\r\n"
echo "--NETWORK CONFIG--"
echo 'grep "net.ipv4.ip_forward parameter" /etc/sysctl.conf SHOULD ALL BE 0 EXCEPT LAST'
grep "net.ipv4.ip_forward parameter" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.all.send_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.all.send_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.default.send_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.default.send_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.all.accept_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.all.accept_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.default.accept_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.default.accept_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.icmp_ignore_bogus_error_responses" /etc/sysctl.conf IDEALLY A 1'
grep "net.ipv4.icmp_ignore_bogus_error_responses" /etc/sysctl.conf
echo "\r\n"
echo "--CORE DUMPS AND EXEC SHIELD--"
echo 'grep"fs.suid_dumpable" /etc/sysctl.conf << fs.suid_dumpable = 0'
grep "fs.suid_dumpable" /etc/sysctl.conf
echo 'grep "hard core" /etc/security/limits.conf << 0'
grep "hard core" /etc/security/limits.conf
echo 'grep "kernel.exec-shield" /etc/sysctl.conf << kernel.exec-shield = 1'
grep "kernel.exec-shield" /etc/sysctl.conf
echo 'grep "kernel.randomize_va_space" /etc/sysctl.conf << kernel.randomize_va_space = 2'
grep "kernel.randomize_va_space" /etc/sysctl.conf
echo "\r\n"
echo "PASSWORD POLICY CHECKS:
echo "VV should output lines that read remember=(something) the something is how far back it goes in preventing reuse of passwords" 
grep "remember*" /etc/pam.d/common-password
grep "remember*" /etc/security/pwquality.conf

