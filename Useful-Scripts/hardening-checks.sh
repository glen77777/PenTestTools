cd /
echo "CHECK FOR RO FLAG IN OPTIONS SECTION, IF NO OUTPUT MANUALLY CHECK FSTAB:"
grep "/boot" /etc/fstab
echo -e "\r\n"
ls -la /etc/grub.conf
echo "^^ENSURE -rwx------ and root:root^^"
echo "VERIFIES USB STORAGE IS DISABLED:"
echo 'grep "blacklist usb_storage" /etc/modprobe.d/blacklist.conf'
grep "blacklist usb_storage" /etc/modprobe.d/blacklist.conf
echo 'grep "modprobe -r usb_storage" /etc/rc.local'
grep "modprobe -r usb_storage" /etc/rc.local
echo -e "\r\n"
echo "LISTS SERVICES LISTENING ON PORTS:"
netstat -antp
echo -e "\r\n"
echo "LISTS ALL PROCESSES < CHECK PERMISSIONS"
ps -A
echo -e "\r\n"
echo "LIST ALL USERS:"
cat /etc/passwd | cut -d ":" -f 1
echo -e "\r\n"
echo "CHECK KEYS FOR INSECURE CONFIGS"
echo "find ~ -iname 'client.pem'"
for pem in $(find / -iname 'client.pem')
  do
  echo
  cat $pem
  echo -e "\r\n"
  done
echo "OTHER PEM FILES:"
echo "find ~ -iname '*.pem'"
for pem in $(find / -iname '*.pem')
  do
  echo $pem
  cat $pem
  echo -e "\r\n"
  done
echo "YUM CONFIG FILES:"
echo 'grep "gpgcheck*" /etc/yum.conf'
grep "gpgcheck*" /etc/yum.conf
echo 'grep "localpkg_gpgcheck*" /etc/yum.conf'
grep "localpkg_gpgcheck*" /etc/yum.conf
echo -e "\r\n"
echo "OPENSSL VERSION"
echo "yum list | grep openssl"
yum list | grep openssl
echo -e "\r\n"
echo "SSH VERSION"
echo "SERVER:"
sshd -V
echo "CLIENT:"
ssh -V
echo "ANY .SSH FILES?"
find / -iname '*.ssh'
echo "SSH CONFIG CHECKS:"
echo 'grep "PermitRootLogin" /etc/ssh/sshd_config << no'
grep "PermitRootLogin" /etc/ssh/sshd_config
echo 'grep "AllowUsers" /etc/ssh/sshd_config << restricted to required users'
grep "AllowUsers" /etc/ssh/sshd_config
echo 'grep "Protocol*" /etc/ssh/sshd_config should be proto 2 lol'
grep "Protocol*" /etc/ssh/sshd_config
echo 'grep "IgnoreRhosts" /etc/ssh/sshd_config << yes'
grep "IgnoreRhosts" /etc/ssh/sshd_config
echo 'grep "PermitUserEnvironment" /etc/ssh/sshd_config << no'
grep "PermitUserEnvironment" /etc/ssh/sshd_config
echo 'grep "PermitTunnel" /etc/ssh/sshd_config << no'
grep "PermitTunnel" /etc/ssh/sshd_config
echo 'grep "HostbasedAuthentication" /etc/ssh/sshd_config << no'
grep "HostbasedAuthentication" /etc/ssh/sshd_config
echo 'grep "PermitEmptyPasswords" /etc/ssh/sshd_config << no'
grep "PermitEmptyPasswords" /etc/ssh/sshd_config
echo 'grep "X11Forwarding" /etc/ssh/sshd_config << no'
grep "X11Forwarding" /etc/ssh/sshd_config
echo 'grep "MaxAuthTries" /etc/ssh/sshd_config << 4 or less'
grep "MaxAuthTries" /etc/ssh/sshd_config
echo 'grep "Ciphers" /etc/ssh/sshd_config << only highest allowed by policy'
grep "Ciphers" /etc/ssh/sshd_config
echo 'grep "ClientAliveInterval" /etc/ssh/sshd_config << 900 or so'
grep "ClientAliveInterval" /etc/ssh/sshd_config
echo 'grep "ClientAliveCountMax" /etc/ssh/sshd_config << 0'
grep "ClientAliveCountMax" /etc/ssh/sshd_config
echo 'grep "UsePAM" /etc/ssh/sshd_config << yes'
grep "UsePAM" /etc/ssh/sshd_config
echo 'grep "AllowTCPForwarding" /etc/ssh/sshd_config << no'
grep "AllowTCPForwarding" /etc/ssh/sshd_config
echo "DISPLAYS BANNER LOCATION:"
grep "Banner" /etc/ssh/sshd_config
ls -la /etc/ssh/sshd_config
echo "^^ensure only WRITABLE BY ROOT^^"
echo -e "\r\n"
echo "shows SELINUX config if applicable:"
cat /etc/selinux/config
echo -e "\r\n"
echo "SYSCTL CHECKS:"
echo -e "\r\n"
echo "--NETWORK CONFIG--"
echo 'grep "net.ipv4.ip_forward parameter" /etc/sysctl.conf SHOULD ALL BE 0 EXCEPT LAST'
grep "net.ipv4.ip_forward parameter" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.all.send_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.all.send_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.default.send_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.default.send_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.all.accept_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.all.accept_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.conf.default.accept_redirects" /etc/sysctl.conf'
grep "net.ipv4.conf.default.accept_redirects" /etc/sysctl.conf
echo 'grep "net.ipv4.icmp_ignore_bogus_error_responses" /etc/sysctl.conf IDEALLY A 1'
grep "net.ipv4.icmp_ignore_bogus_error_responses" /etc/sysctl.conf
echo -e "\r\n"
echo "--CORE DUMPS AND EXEC SHIELD--"
echo 'grep"fs.suid_dumpable" /etc/sysctl.conf << fs.suid_dumpable = 0'
grep "fs.suid_dumpable" /etc/sysctl.conf
echo 'grep "hard core" /etc/security/limits.conf << 0'
grep "hard core" /etc/security/limits.conf
echo 'grep "kernel.exec-shield" /etc/sysctl.conf << kernel.exec-shield = 1'
grep "kernel.exec-shield" /etc/sysctl.conf
echo 'grep "kernel.randomize_va_space" /etc/sysctl.conf << kernel.randomize_va_space = 2'
grep "kernel.randomize_va_space" /etc/sysctl.conf
echo -e "\r\n"
echo "AUDIT.RULES OUTPUT"
cat /etc/audit/audit.rules
echo -e "\r\n"
echo "PASSWORD POLICY CHECKS:"
echo "VV should output lines that read remember=(something) the something is how far back it prevents reuse of passwords" 
grep "remember*" /etc/pam.d/common-password
grep "remember*" /etc/security/pwquality.conf
echo -e "\r\n"
echo "----INTERPRETER/COMPILER CHECKS:----"
echo -e "\r\n"
echo "JAVA CHECK"
for inter in $(find / -iname 'java')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo "PYTHON CHECK"
for inter in $(find / -iname 'python')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo "PYTHON 3 CHECK"  
for inter in $(find / -iname 'python3')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo "RUBY CHECK"  
for inter in $(find / -iname 'ruby')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo "PERL"  
for inter in $(find / -iname 'perl')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo "GCC"  
for inter in $(find / -iname 'gcc')
  do
  echo "interpreter possible"
  echo $inter
  $inter -version
  done
echo -e "\r\n"
echo "DO WE HAVE SECURETTY?"
cat /etc/securetty
